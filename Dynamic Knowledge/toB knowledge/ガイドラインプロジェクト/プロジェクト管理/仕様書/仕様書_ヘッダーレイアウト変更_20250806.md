# ヘッダーレイアウト変更仕様書

**作成日**: 2025年8月6日  
**作成者**: Claude Code（Elon Musk モード）

## 概要

Harukazeガイドラインサイトのヘッダーレイアウトを、PC版において固定ヘッダーバー形式に変更した。この変更により、ナビゲーションの利便性向上と画面の有効活用を実現した。

## 変更前の仕様

### PC版
- コンテンツエリア内にヘッダーが配置
- ページタイトルがヘッダー内に表示
- 検索ボックスがヘッダー内に配置
- スクロール時にヘッダーが画面外に消える

### モバイル版
- ハンバーガーメニューとサイト名の表示（変更なし）

## 変更後の仕様

### PC版
1. **固定ヘッダーバー**
   - 画面上部に固定（position: fixed）
   - 高さ: 60px
   - 背景色: var(--bg-primary)
   - 下部ボーダー: 1px solid var(--border)
   - z-index: 1000（他の要素より前面に表示）

2. **ヘッダー内要素**
   - **左側**: サイト名「Harukazeガイドライン」
     - フォントサイズ: 20px
     - フォントウェイト: 600
     - ホームページへのリンク機能
   - **右側**: 検索ボックス
     - 既存の検索機能を維持

3. **ページタイトル**
   - ヘッダーから除去
   - コンテンツエリアの最上部に移動
   - h1タグとして表示（class="page-title"）

4. **レイアウト調整**
   - メインコンテンツの上部マージン: 84px（ヘッダー60px + 余白24px）
   - サイドバーの上部位置調整

### モバイル版
- 変更なし（既存の仕様を維持）

## 技術的実装詳細

### 1. HTMLテンプレートの変更 (`page_light_with_ai.html`)

```html
<!-- PC用グローバルヘッダー -->
<div class="global-header" id="globalHeader">
    <a href="index.html" class="site-name">Harukazeガイドライン</a>
    <div class="search-container">
        <!-- 検索ボックス -->
    </div>
</div>
```

### 2. CSSの主な変更点

```css
/* 固定ヘッダー */
.global-header {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    height: 60px;
    background: var(--bg-primary);
    border-bottom: 1px solid var(--border);
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0 24px;
    z-index: 1000;
    box-shadow: 0 1px 3px rgba(0,0,0,0.05);
}

/* メインコンテンツの調整 */
.main {
    margin-top: 84px; /* ヘッダー分の余白を確保 */
}
```

### 3. Python生成スクリプトの変更 (`generate_auto.py`)

#### タイトル重複防止機能
```python
# h1タグがコンテンツに含まれている場合は削除（タイトルの重複を防ぐ）
from bs4 import BeautifulSoup
soup = BeautifulSoup(html_content, 'html.parser')
first_h1 = soup.find('h1')
if first_h1 and first_h1.text.strip() == page['title']:
    first_h1.decompose()  # 最初のh1タグを削除
    html_content = str(soup)

# ページタイトルをコンテンツエリアに追加
output = output.replace('{{CONTENT}}', f'<h1 class="page-title">{page["title"]}</h1>\n{html_content}')
```

#### AIチャット表記の修正
- Markdownファイルのh1タグからタイトルを正確に抽出
- サイドバーでの表示時に「（テスト版）」を除去

## 対応したバグ・課題

1. **タイトルの重複表示**
   - 原因: Markdownファイルのh1タグとテンプレートで生成されるタイトルの両方が表示
   - 解決: BeautifulSoupを使用して重複するh1タグを自動検出・削除

2. **AIチャットの表記統一**
   - 問題: "Aiチャット"と"AIチャット"の表記揺れ
   - 解決: Markdownファイルのh1タグから正確にタイトルを抽出する処理を追加

## メリット

1. **ナビゲーションの改善**
   - 常時表示されるヘッダーにより、どのページからもホームへの移動が容易
   - 検索機能への即座のアクセス

2. **画面の有効活用**
   - コンテンツエリアの拡大
   - スクロール時もヘッダーが維持される

3. **一貫性のあるUI**
   - すべてのページで統一されたヘッダー表示
   - プロフェッショナルな外観

## 今後の検討事項

1. ヘッダーの高さ最適化（現在60px）
2. スクロール時のヘッダー表示/非表示アニメーション
3. パンくずリストの追加検討
4. ダークモード対応

## ファイル変更履歴

- 2025年8月6日: 初回実装
  - `_templates/page_light_with_ai.html`: ヘッダー構造の変更
  - `site_generator/generate_auto.py`: タイトル処理ロジックの改善
  - 全HTML出力ファイル: 再生成による更新

## 関連コミット

- `237a362`: PCヘッダーのレイアウトを変更：固定ヘッダーバーの実装
- `eeb1fe8`: AIチャットの表記を修正

---

この仕様書は、第一原理思考に基づき、ユーザビリティの本質的な改善を目指して実装された変更を記録したものである。シンプルさと機能性のバランスを保ちながら、最小限の変更で最大の効果を実現した。